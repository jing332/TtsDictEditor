name: Build Test

on:
    push:
        branches:
            - "master"
        paths-ignore:
            - "README.md"
    workflow_dispatch:

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v3
            - uses: actions/setup-java@v3
              with:
                  distribution: temurin
                  java-version: 17

            - name: Setup Gradle
              uses: gradle/gradle-build-action@v2

            - name: Grant execute permission for gradlew
              run: chmod +x gradlew
            - name: Build with Gradle
              run: ./gradlew assembleRelease --build-cache --parallel --daemon --warning-mode all

            - name: Upload App To Artifact
              uses: actions/upload-artifact@v3
              with:
                  name: "TtsDictEditor"
                  path: ${{ github.workspace }}/app/build/outputs/apk/release/*.apk